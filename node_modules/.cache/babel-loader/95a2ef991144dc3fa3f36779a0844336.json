{"remainingRequest":"/Users/aaronh/Downloads/abstratica-web/node_modules/babel-loader/lib/index.js!/Users/aaronh/Downloads/abstratica-web/node_modules/eslint-loader/index.js??ref--14-0!/Users/aaronh/Downloads/abstratica-web/src/lib/transaction.js","dependencies":[{"path":"/Users/aaronh/Downloads/abstratica-web/src/lib/transaction.js","mtime":1653334282000},{"path":"/Users/aaronh/Downloads/abstratica-web/babel.config.js","mtime":1653334282000},{"path":"/Users/aaronh/Downloads/abstratica-web/node_modules/cache-loader/dist/cjs.js","mtime":1693191335836},{"path":"/Users/aaronh/Downloads/abstratica-web/node_modules/babel-loader/lib/index.js","mtime":1693191336222},{"path":"/Users/aaronh/Downloads/abstratica-web/node_modules/eslint-loader/index.js","mtime":1693191335906}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9hYXJvbmgvRG93bmxvYWRzL2Fic3RyYXRpY2Etd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgeyBLZXlwYWlyLCBTeXN0ZW1Qcm9ncmFtIH0gZnJvbSAiQHNvbGFuYS93ZWIzLmpzIjsKLyoqCiAqIGNyYWZ0IE5GVCBtaW50IHJlcXVlc3QgdHJhbnNhY3Rpb24KICogQHBhcmFtIHtDb25uZWN0aW9ufSBjb25uZWN0aW9uIGNvbm5lY3Rpb24KICogQHBhcmFtIHtQdWJsaWNLZXl9IGJ1eWVyS2V5CiAqIEBwYXJhbSB7UHVibGljS2V5fSBhZG1pbktleQogKiBAcGFyYW0ge051bWJlcn0gbGFtcG9ydHMgcHJpY2UgaW4gbGFtcG9ydHMKICovCgpleHBvcnQgZnVuY3Rpb24gY3JlYXRlTWludFJlcXVlc3RUcmFuc2NhdGlvbihfeCwgX3gyLCBfeDMsIF94NCkgewogIHJldHVybiBfY3JlYXRlTWludFJlcXVlc3RUcmFuc2NhdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfY3JlYXRlTWludFJlcXVlc3RUcmFuc2NhdGlvbigpIHsKICBfY3JlYXRlTWludFJlcXVlc3RUcmFuc2NhdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShjb25uZWN0aW9uLCBidXllcktleSwgYWRtaW5LZXksIGxhbXBvcnRzKSB7CiAgICB2YXIgbmV3Tm9uY2VBY2NvdW50LCBjcmVhdGVOb25jZUFjY291bnRQYXJhbXMsIHRyYW5zYWN0aW9uOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBuZXdOb25jZUFjY291bnQgPSBLZXlwYWlyLmdlbmVyYXRlKCk7CiAgICAgICAgICAgIGNyZWF0ZU5vbmNlQWNjb3VudFBhcmFtcyA9IHsKICAgICAgICAgICAgICBhdXRob3JpemVkUHVia2V5OiBhZG1pbktleSwKICAgICAgICAgICAgICBmcm9tUHVia2V5OiBidXllcktleSwKICAgICAgICAgICAgICBsYW1wb3J0czogbGFtcG9ydHMsCiAgICAgICAgICAgICAgbm9uY2VQdWJrZXk6IG5ld05vbmNlQWNjb3VudC5wdWJsaWNLZXkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSBTeXN0ZW1Qcm9ncmFtLmNyZWF0ZU5vbmNlQWNjb3VudChjcmVhdGVOb25jZUFjY291bnRQYXJhbXMpOyAvLyBhZGQgc21hbGwgU09MIGl4IHRvIGFkbWluIHRvIGZpbmQgdGhpcyB0cmFuc2FjdGlvbiBieSBnZXRDb25maXJtZWRTaWduYXR1cmVzRm9yQWRkcmVzcwoKICAgICAgICAgICAgdHJhbnNhY3Rpb24uYWRkKFN5c3RlbVByb2dyYW0udHJhbnNmZXIoewogICAgICAgICAgICAgIGZyb21QdWJrZXk6IGJ1eWVyS2V5LAogICAgICAgICAgICAgIGxhbXBvcnRzOiAxMDAwLAogICAgICAgICAgICAgIHRvUHVia2V5OiBhZG1pbktleQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHRyYW5zYWN0aW9uLmZlZVBheWVyID0gYnV5ZXJLZXk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5nZXRSZWNlbnRCbG9ja2hhc2goIm1heCIpOwoKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgdHJhbnNhY3Rpb24ucmVjZW50QmxvY2toYXNoID0gX2NvbnRleHQuc2VudC5ibG9ja2hhc2g7CiAgICAgICAgICAgIHRyYW5zYWN0aW9uLnBhcnRpYWxTaWduKG5ld05vbmNlQWNjb3VudCk7IC8vIHRvIGJlIHNpZ25lZAoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdHJhbnNhY3Rpb24pOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwogIHJldHVybiBfY3JlYXRlTWludFJlcXVlc3RUcmFuc2NhdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9"},{"version":3,"sources":["/Users/aaronh/Downloads/abstratica-web/src/lib/transaction.js"],"names":["Keypair","SystemProgram","createMintRequestTranscation","connection","buyerKey","adminKey","lamports","newNonceAccount","generate","createNonceAccountParams","authorizedPubkey","fromPubkey","noncePubkey","publicKey","transaction","createNonceAccount","add","transfer","toPubkey","feePayer","getRecentBlockhash","recentBlockhash","blockhash","partialSign"],"mappings":";;AAAA,SAASA,OAAT,EAAkBC,aAAlB,QAAuC,iBAAvC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,gBAAsBC,4BAAtB;AAAA;AAAA;;;0FAAO,iBACLC,UADK,EAELC,QAFK,EAGLC,QAHK,EAILC,QAJK;AAAA;AAAA;AAAA;AAAA;AAAA;AAMCC,YAAAA,eAND,GAMmBP,OAAO,CAACQ,QAAR,EANnB;AAQCC,YAAAA,wBARD,GAQ4B;AAC/BC,cAAAA,gBAAgB,EAAEL,QADa;AAE/BM,cAAAA,UAAU,EAAEP,QAFmB;AAG/BE,cAAAA,QAAQ,EAAEA,QAHqB;AAI/BM,cAAAA,WAAW,EAAEL,eAAe,CAACM;AAJE,aAR5B;AAeCC,YAAAA,WAfD,GAeeb,aAAa,CAACc,kBAAd,CAClBN,wBADkB,CAff,EAmBL;;AACAK,YAAAA,WAAW,CAACE,GAAZ,CACEf,aAAa,CAACgB,QAAd,CAAuB;AACrBN,cAAAA,UAAU,EAAEP,QADS;AAErBE,cAAAA,QAAQ,EAAE,IAFW;AAGrBY,cAAAA,QAAQ,EAAEb;AAHW,aAAvB,CADF;AAOAS,YAAAA,WAAW,CAACK,QAAZ,GAAuBf,QAAvB;AA3BK;AAAA,mBA6BGD,UAAU,CAACiB,kBAAX,CAA8B,KAA9B,CA7BH;;AAAA;AA4BLN,YAAAA,WAAW,CAACO,eA5BP,iBA8BHC,SA9BG;AA+BLR,YAAAA,WAAW,CAACS,WAAZ,CAAwBhB,eAAxB,EA/BK,CAgCL;;AAhCK,6CAiCEO,WAjCF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import { Keypair, SystemProgram } from \"@solana/web3.js\";\n\n/**\n * craft NFT mint request transaction\n * @param {Connection} connection connection\n * @param {PublicKey} buyerKey\n * @param {PublicKey} adminKey\n * @param {Number} lamports price in lamports\n */\nexport async function createMintRequestTranscation(\n  connection,\n  buyerKey,\n  adminKey,\n  lamports\n) {\n  const newNonceAccount = Keypair.generate();\n\n  const createNonceAccountParams = {\n    authorizedPubkey: adminKey,\n    fromPubkey: buyerKey,\n    lamports: lamports,\n    noncePubkey: newNonceAccount.publicKey,\n  };\n\n  const transaction = SystemProgram.createNonceAccount(\n    createNonceAccountParams\n  );\n\n  // add small SOL ix to admin to find this transaction by getConfirmedSignaturesForAddress\n  transaction.add(\n    SystemProgram.transfer({\n      fromPubkey: buyerKey,\n      lamports: 1000,\n      toPubkey: adminKey,\n    })\n  );\n  transaction.feePayer = buyerKey;\n  transaction.recentBlockhash = (\n    await connection.getRecentBlockhash(\"max\")\n  ).blockhash;\n  transaction.partialSign(newNonceAccount);\n  // to be signed\n  return transaction;\n}\n"]}]}